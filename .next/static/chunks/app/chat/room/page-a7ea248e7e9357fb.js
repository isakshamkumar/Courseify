(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[158],{5651:function(e,t,s){Promise.resolve().then(s.bind(s,5575))},5575:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var l=s(7437),r=s(6308),i=s(2265),n=s(5926),a=s(8910),o=s(7267),c=s(3591),d=s(6468),x=s(3046),u=s(4033),h=s(6519),m=s(5925),p=e=>{let{selectedRoom:t}=e,s=(0,i.useRef)(null),[r,p]=(0,i.useState)(0),[g,f]=(0,i.useState)(null),[y,v]=(0,i.useState)(null),j=(0,x.v9)(e=>e.user.user.name),b=(0,u.useSearchParams)().get("id"),w=(0,x.v9)(e=>e.user.user.id),N=(0,x.v9)(e=>e.user.user.image);N||(N="https://img.freepik.com/free-vector/illustration-businessman_53876-5856.jpg?w=900&t=st=1710411817~exp=1710412417~hmac=d584b8e8042241ce72ae392dd2cf2c031f8a25626e101f9d94dda0a4bb5b3a13");let{socket:k}=(0,i.useContext)(h.Z);(0,i.useEffect)(()=>{let e=localStorage.getItem("connectedUserCount");return p(+e),(null==k?void 0:k.connected)?(m.Am.success("Connected to socket server in ChatPage"),k.on("chat:new-message",e=>{var t;if(e.file&&(null===(t=e.file)||void 0===t?void 0:t.type)){let t=new Blob([e.file.data],{type:e.file.type}),s=new File([t],"filename",{type:e.file.type});e.file=s}U(t=>(setTimeout(()=>{S()},0),[...t,e]))}),k.on("user:connection-count-updated:",e=>{p(e.count)})):m.Am.error("Not connected to socket server"),()=>{}},[]);let C=i.useRef(null),S=()=>{C.current&&C.current.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})};function R(){var e=new Date,t=("0"+(e.getMonth()+1)).slice(-2),s=("0"+e.getDate()).slice(-2),l=e.getFullYear(),r=Number(("0"+e.getHours()).slice(-2)),i=("0"+e.getMinutes()).slice(-2),n=r>=12?"PM":"AM";return r%=12,{date:t+"/"+s+"/"+l,time:(r=r||12)+":"+i+" "+n}}let[I,U]=(0,i.useState)([]),_=e=>{e.preventDefault();let{date:t,time:l}=R(),r={holder:j,holderImgSrc:N,time:l,userId:w,date:t,msg:s.current.value,room:b};k&&(k.emit("msg",r),s.current.value="")};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.x7,{}),(0,l.jsxs)("div",{style:{borderRight:"1px solid gray",width:"79%",marginLeft:"3%",height:"100vh",padding:"15px 10px ",background:"transparent"},className:"",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-3 ",children:[(0,l.jsx)("h3",{style:{textAlign:"center",fontSize:"22px",color:"white"},children:t}),(0,l.jsxs)("div",{style:{display:"flex",gap:"5px",fontSize:"16px",justifyContent:"center",alignItems:"center"},children:[(0,l.jsx)(o.WCB,{color:"white"})," ",(0,l.jsxs)("div",{style:{color:"white"},children:[r," Users Online"]})]})]}),(0,l.jsxs)("div",{style:{border:"1px solid gray",borderRadius:"20px",width:"90%",height:"93%",margin:"auto",padding:"20px 20px",position:"relative",background:"inherit"},children:[(0,l.jsx)("ul",{className:"scroll",style:{display:"flex",flexDirection:"column",gap:"15px",height:"91%",overflowY:"auto",scrollbarWidth:"thin"},children:I.map((e,t)=>(0,l.jsxs)("li",{ref:t===I.length-1?C:null,style:{borderRadius:e.holder!==j?"1px 10px 10px 10px":"10px 1px 10px 10px",height:"fit-content",padding:"10px",marginRight:e.holder===j?"15px":"",minWidth:"40%",width:"fit-content",maxWidth:"60%",fontSize:"16px",alignSelf:e.holder===j?"flex-end":"flex-start"},className:"".concat(e.holder!==j?"bg-slate-600":"bg-zinc-600"," "),children:[(0,l.jsxs)("div",{style:{display:"flex",marginBottom:"3px",justifyContent:"flex-start",alignItems:"center",gap:"10px",width:"100%",color:"silver"},children:[(0,l.jsx)("img",{style:{borderRadius:"50%",height:"33px",width:"33px"},src:e.holderImgSrc})," ",e.holder,(0,l.jsx)("span",{className:"space-x-2",style:{color:"silver"},children:e.date}),(0,l.jsx)("span",{className:"space-x-2",style:{color:"silver"},children:e.time})]}),(0,l.jsx)("div",{style:{marginTop:"6px"},children:e.msg&&(0,l.jsx)("div",{style:{height:"fit-content",wordWrap:"break-word",color:"white"},children:e.msg})}),(null==e?void 0:e.file)&&(0,l.jsxs)("div",{className:"relative group",children:[(0,l.jsx)(a.Mmr,{color:"white",size:"25",style:{left:"50%",top:"50%",transform:"translate(-50%,-50%)"},className:"absolute hidden group-hover:block"}),(0,l.jsx)(n.Z,{small:e.file,large:e.file,alt:"Selected File"})]})]},t))}),(0,l.jsxs)("div",{style:{padding:"10px",position:"absolute",bottom:"5px",left:"69px",width:"85%",display:"flex",justifyContent:"center",alignItems:"center",gap:"21px"},children:[(0,l.jsx)("label",{htmlFor:"fileInput",style:{cursor:"pointer"},children:(0,l.jsx)(d._mA,{color:"white",size:30})}),(0,l.jsx)("input",{id:"fileInput",type:"file",style:{display:"none"},onChange:e=>{let t=e.target.files[0];v(e.target.files[0]);let{time:l,date:r}=R(),i=new FileReader;i.onload=e=>{let t={holder:j,holderImgSrc:N,time:l,userId:w,date:r,msg:s.current.value,file:e.target.result,room:b};k&&(k.emit("msg",t),s.current.value="")},i.readAsDataURL(t)}}),(0,l.jsx)("input",{ref:s,type:"text",id:"first_name",onKeyDown:e=>{"Enter"===e.key&&_(e)},className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg  w-full p-4",placeholder:"Enter Message"}),(0,l.jsx)(c.Z,{onClick:_,children:"Send"})]})]})]})]})},g=s(3159),f=e=>{let{selectedRoom:t,setSelectedRoom:s}=e;return(0,l.jsxs)("div",{className:"w-[200px] h-screen bg-transparent flex flex-col pt-8",children:[(0,l.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,l.jsx)("h3",{className:"text-white text-lg font-semibold",children:"Users in Room"})}),(0,l.jsx)("div",{className:"flex flex-col space-y-2",children:[{name:"User 1",typing:!0},{name:"User 2",typing:!1},{name:"User 3",typing:!0},{name:"User 4",typing:!1},{name:"User 5",typing:!0}].map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center py-2 px-4 rounded-md hover:bg-gray-700 transition duration-300",children:[(0,l.jsx)("div",{className:"h-8 w-8 flex-shrink-0",children:(0,l.jsx)(g.Xws,{className:"text-white"})}),(0,l.jsxs)("div",{className:"ml-3 flex flex-col",children:[(0,l.jsx)("span",{className:"text-white font-medium",children:e.name}),e.typing&&(0,l.jsx)("div",{className:"text-gray-400 text-xs",children:"Typing..."})]})]},t))})]})},y=e=>{let[t,s]=(0,i.useState)(!0);(0,i.useEffect)(()=>{setTimeout(()=>{s(!1)},2e3)},[]);let n=(0,u.useSearchParams)().get("r"),[a,o]=(0,i.useState)(n);return(0,l.jsx)(l.Fragment,{children:t?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center w-full h-screen",children:[(0,l.jsx)(r.Z,{})," Loading Chat Portal..."]}):(0,l.jsxs)("div",{className:"flex ",style:{background:"radial-gradient(circle at center, #1C1425, #18132A)"},children:[(0,l.jsx)(p,{selectedRoom:a}),(0,l.jsx)(f,{selectedRoom:a,setSelectedRoom:o})]})})}},6519:function(e,t,s){"use strict";var l=s(2265);let r=(0,l.createContext)(null);t.Z=r},3591:function(e,t,s){"use strict";var l=s(7437);s(2265),t.Z=e=>{let{children:t,onClick:s}=e;return(0,l.jsx)("button",{onClick:s,className:"inline-block rounded bg-emerald-600 px-12 py-3 text-sm font-medium text-white transition hover:bg-emerald-700 focus:outline-none focus:ring focus:ring-yellow-400",children:t})}},6308:function(e,t,s){"use strict";var l=s(7437);t.Z=()=>(0,l.jsxs)("svg",{className:"animate-spin h-8 w-8 mr-3",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},function(e){e.O(0,[582,190,420,104,46,726,926,971,472,744],function(){return e(e.s=5651)}),_N_E=e.O()}]);